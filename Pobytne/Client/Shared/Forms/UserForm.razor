@using System.ComponentModel.DataAnnotations;

@if(user is not null)
{
    <EditForm Model="@user" OnValidSubmit=OnValidSubmitHandler>
	    <DataAnnotationsValidator />

        <div class="row align-items-start">
            <div class="col">
                <HxInputText @bind-Value="user.UserLogin" Label="Login" Type="InputType.Text"/>
            </div>
            <div class="col">
                <HxInputText @bind-Value="user.UserName" Label="Jméno uživatele" Type="InputType.Text" />
            </div>
        </div>
        <div class="row align-items-start">
            <div class="col">
                <HxInputText @bind-Value="user.Email" Label="Email" Type="InputType.Email" />
            </div>
            <div class="col">
                <HxInputText @bind-Value="user.PhoneNumber" Label="Telefonní číslo" Type="InputType.Tel" />
            </div>
        </div>
        <div class="row align-items-start">
		    <div class="col">		
                <HxInputNumber Label="Číslo licence" CssClass="mb-3" Decimals="0" TValue="int" @bind-Value="user.LicenseNumber" Enabled="false" />
            </div>
		    <div class="col">
                <HxInputDate CalendarIcon="BootstrapIcon.Calendar" @bind-Value="user.ValidTo" MinDate=DateTime.Now.AddDays(1) Label="Platný do" />
            </div>
        </div>

        <HxSwitch Text="Je aktivní" @bind-Value="user.Valid" />

        <div class="d-grid gap-2">
            <HxSubmit Color="ThemeColor.Success">@ButtonText</HxSubmit>
        </div>

    </EditForm>
}

@code {
    [EditorRequired]
    [Parameter]
    public User? user { get; set; }
    [EditorRequired]
    [Parameter]
    public EForm formType { get; set; }
    [EditorRequired]
    [Parameter]
    public EventCallback<EForm> OnValidSubmit{ get; set; }
    private string ButtonText
    {
        get
        {
            if (formType == EForm.Insert) return "Vložit";
            return "Aktualizovat";
        }
    }
    private async Task OnValidSubmitHandler() => await OnValidSubmit.InvokeAsync(formType);

}
